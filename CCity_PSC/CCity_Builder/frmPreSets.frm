VERSION 5.00
Begin VB.Form frmPreSets 
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Preset PLAN Shapes"
   ClientHeight    =   3495
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   2445
   LinkTopic       =   "Form2"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   233
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   163
   StartUpPosition =   3  'Windows Default
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   19
      Left            =   1830
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   20
      Top             =   2370
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   18
      Left            =   1245
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   19
      Top             =   2370
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   17
      Left            =   645
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   18
      Top             =   2370
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   16
      Left            =   30
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   17
      Top             =   2370
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   15
      Left            =   1830
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   16
      Top             =   1785
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   14
      Left            =   1245
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   15
      Top             =   1785
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   13
      Left            =   645
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   14
      Top             =   1785
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   12
      Left            =   30
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   13
      Top             =   1785
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   11
      Left            =   1830
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   12
      Top             =   1200
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   10
      Left            =   1245
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   11
      Top             =   1200
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   9
      Left            =   645
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   10
      Top             =   1215
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   8
      Left            =   45
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   9
      Top             =   1215
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   7
      Left            =   1830
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   8
      Top             =   630
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   6
      Left            =   1245
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   7
      Top             =   630
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   5
      Left            =   645
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   6
      Top             =   630
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   4
      Left            =   45
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   5
      Top             =   630
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   3
      Left            =   1830
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   4
      Top             =   45
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   2
      Left            =   1230
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   3
      Top             =   45
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   1
      Left            =   630
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   2
      Top             =   45
      Width           =   540
   End
   Begin VB.PictureBox picP 
      BackColor       =   &H00FFFFFF&
      Height          =   540
      Index           =   0
      Left            =   45
      ScaleHeight     =   -32
      ScaleLeft       =   1
      ScaleMode       =   0  'User
      ScaleTop        =   32
      ScaleWidth      =   32
      TabIndex        =   0
      Top             =   45
      Width           =   540
   End
   Begin VB.Label LabIndex 
      Alignment       =   2  'Center
      Caption         =   "0"
      Height          =   210
      Left            =   2130
      TabIndex        =   21
      Top             =   3255
      Width           =   210
   End
   Begin VB.Label Label1 
      Caption         =   "Click on shape to add to whole RC square."
      Height          =   480
      Left            =   60
      TabIndex        =   1
      Top             =   2985
      Width           =   1875
   End
End
Attribute VB_Name = "frmPreSets"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
' frmPreSets (frmPreSets.bas)

Option Explicit
Option Base 1


'--------------------------------------------------------------------------
'  API to make application stay on top
Private Declare Function SetWindowPos Lib "user32" (ByVal hWnd As Long, _
ByVal hWndInsertAfter As Long, ByVal X As Long, ByVal Y As Long, _
ByVal wi As Long, ByVal ht As Long, ByVal wFlags As Long) As Long

Const hWndInsertAfter = -1
Const wFlags = &H40 Or &H20
'---------------------------------------------------------------------------
Dim pLX() As Integer, pLZ() As Integer, pLY() As Integer
Dim pHX() As Integer, pHZ() As Integer, pHY() As Integer
Dim NIndex() As Long ' Index to start reading
Dim NOB() As Long  ' Num blocks in each set
Dim NB As Long


Private Sub Form_Load()
Dim FW As Long, FH As Long
FW = frmPreSets.Width
FH = frmPreSets.Height
' Size & Make frmPresets stay on top
res = SetWindowPos(frmPreSets.hWnd, hWndInsertAfter, _
   430, 200, FW \ STX, FH \ STY, wFlags)

frmPreSets.Show

LoadCoords

DrawShapes


End Sub


Private Sub Form_Unload(Cancel As Integer)
Unload frmPreSets
End Sub

'Private Sub cmdClosePresets_Click()
'   Unload frmPreSets
'End Sub

Private Sub picP_Click(Index As Integer)
   LabIndex = Trim$(Str$(Index))
   ' Num to read = NOB(Index+1)
   ' starting at NIndex(Index+1)
   NB = NumBlocks + 1
   NumBlocks = NumBlocks + NOB(Index + 1)
   ReDimPreserveLH
   For i = NIndex(Index + 1) To NIndex(Index + 1) + NOB(Index + 1) - 1
      LX(NB) = pLX(i)
      LZ(NB) = pLZ(i)
      LY(NB) = 1
      HX(NB) = pHX(i)
      HZ(NB) = pHZ(i)
      HY(NB) = LY(NB) + DummyHeight
      NR(NB) = R
      NC(NB) = C
      NumBlocksInRC(NR(NB), NC(NB)) = NumBlocksInRC(NR(NB), NC(NB)) + 1
      NB = NB + 1
   Next i
   
   Form1.LabNumBlocks = "NumBlocks =" & Str$(NumBlocks)
   RedBlockNumber = NumBlocks
   REDRAW_PLAN Form1.picPLAN
   DRAW_Faces Form1.picFace
   'Unload Me
End Sub

Private Sub picP_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
   'Label1 = Str$(X) & Str$(Y)

End Sub

Private Sub ReDimPreserveLH()
   If NB = 1 Then
      ReDim LX(NumBlocks)
      ReDim LZ(NumBlocks)
      ReDim LY(NumBlocks)
      ReDim HX(NumBlocks)
      ReDim HZ(NumBlocks)
      ReDim HY(NumBlocks)
      ReDim NR(NumBlocks)
      ReDim NC(NumBlocks)
   Else
      ReDim Preserve LX(NumBlocks)
      ReDim Preserve LZ(NumBlocks)
      ReDim Preserve LY(NumBlocks)
      ReDim Preserve HX(NumBlocks)
      ReDim Preserve HZ(NumBlocks)
      ReDim Preserve HY(NumBlocks)
      ReDim Preserve NR(NumBlocks)
      ReDim Preserve NC(NumBlocks)
   End If
End Sub

Private Sub DrawShapes()
' Draw presets
'picP(0).Line (1, 1)-(32, 8), 0, B
Dim ixL As Long
Dim izL As Long
Dim ixH As Long
Dim izH As Long

   For i = 0 To 19
      For j = NIndex(i + 1) To NIndex(i + 1) + NOB(i + 1) - 1
         ixL = pLX(j): If ixL > 1 Then ixL = ixL \ 8
         izL = pLZ(j): If izL > 1 Then izL = izL \ 8
         ixH = pHX(j): If ixH > 1 Then ixH = ixH \ 8
         izH = pHZ(j): If izH > 1 Then izH = izH \ 8
         picP(i).Line (ixL, izL)-(ixH, izH), 0, B
      Next j
   Next i
End Sub

Private Sub LoadCoords()
ReDim pLX(1 To 38)
ReDim pLZ(1 To 38)
ReDim pLY(1 To 38)
ReDim pHX(1 To 38)
ReDim pHZ(1 To 38)
ReDim pHY(1 To 38)
ReDim NOB(1 To 38)
ReDim NIndex(1 To 20)
   
   NOB(1) = 1: NIndex(1) = 1
      pLX(1) = 1:   pLZ(1) = 240: pHX(1) = 256: pHZ(1) = 256
   NOB(2) = 1: NIndex(2) = 2
      pLX(2) = 1:    pLZ(2) = 1:  pHX(2) = 32:  pHZ(2) = 256
   NOB(3) = 1: NIndex(3) = 3
      pLX(3) = 1:   pLZ(3) = 1:   pHX(3) = 256: pHZ(3) = 32
   NOB(4) = 1: NIndex(4) = 4
      pLX(4) = 240: pLZ(4) = 1:   pHX(4) = 256: pHZ(4) = 256

   NOB(5) = 2: NIndex(5) = 5
      pLX(5) = 1:   pLZ(5) = 240: pHX(5) = 256: pHZ(5) = 256
      pLX(6) = 240: pLZ(6) = 1:   pHX(6) = 256: pHZ(6) = 240
   NOB(6) = 2: NIndex(6) = 7
      pLX(7) = 1:   pLZ(7) = 240: pHX(7) = 256: pHZ(7) = 256
      pLX(8) = 1:   pLZ(8) = 1:   pHX(8) = 32:  pHZ(8) = 240
   NOB(7) = 2: NIndex(7) = 9
      pLX(9) = 1:   pLZ(9) = 32:  pHX(9) = 32:   pHZ(9) = 256
      pLX(10) = 1:  pLZ(10) = 1:  pHX(10) = 256: pHZ(10) = 32
   NOB(8) = 2: NIndex(8) = 11
      pLX(11) = 1:   pLZ(11) = 1:   pHX(11) = 256: pHZ(11) = 32
      pLX(12) = 240: pLZ(12) = 32:  pHX(12) = 256: pHZ(12) = 256
   
   NOB(9) = 2: NIndex(9) = 13
      pLX(13) = 1: pLZ(13) = 96:  pHX(13) = 160: pHZ(13) = 160
      pLX(14) = 96: pLZ(14) = 160:  pHX(14) = 160: pHZ(14) = 256
   NOB(10) = 2: NIndex(10) = 15
      pLX(15) = 1: pLZ(15) = 96:  pHX(15) = 160: pHZ(15) = 160
      pLX(16) = 96: pLZ(16) = 1:  pHX(16) = 160: pHZ(16) = 96
   NOB(11) = 2: NIndex(11) = 17
      pLX(17) = 96: pLZ(17) = 1:  pHX(17) = 160: pHZ(17) = 96
      pLX(18) = 96: pLZ(18) = 96:  pHX(18) = 256: pHZ(18) = 160
   NOB(12) = 2: NIndex(12) = 19
      pLX(19) = 96: pLZ(19) = 96:  pHX(19) = 256: pHZ(19) = 160
      pLX(20) = 96: pLZ(20) = 160:  pHX(20) = 160: pHZ(20) = 256

   NOB(13) = 2: NIndex(13) = 21
      pLX(21) = 1: pLZ(21) = 96:  pHX(21) = 256: pHZ(21) = 160
      pLX(22) = 96: pLZ(22) = 160:  pHX(22) = 160: pHZ(22) = 256
   NOB(14) = 2: NIndex(14) = 23
      pLX(23) = 1: pLZ(23) = 96:  pHX(23) = 96: pHZ(23) = 160
      pLX(24) = 96: pLZ(24) = 1:  pHX(24) = 160: pHZ(24) = 256
   NOB(15) = 2: NIndex(15) = 25
      pLX(25) = 1: pLZ(25) = 96:  pHX(25) = 256: pHZ(25) = 160
      pLX(26) = 96: pLZ(26) = 1:  pHX(26) = 160: pHZ(26) = 96
   NOB(16) = 2: NIndex(16) = 27
      pLX(27) = 96: pLZ(27) = 1:  pHX(27) = 160: pHZ(27) = 256
      pLX(28) = 160: pLZ(28) = 96:  pHX(28) = 256: pHZ(28) = 160

   NOB(17) = 1: NIndex(17) = 29
      pLX(29) = 1: pLZ(29) = 96:  pHX(29) = 256: pHZ(29) = 160
   NOB(18) = 1: NIndex(18) = 30
      pLX(30) = 96: pLZ(30) = 1:  pHX(30) = 160: pHZ(30) = 256
   NOB(19) = 3: NIndex(19) = 31
      pLX(31) = 1: pLZ(31) = 96:  pHX(31) = 256: pHZ(31) = 160
      pLX(32) = 96: pLZ(32) = 1:  pHX(32) = 160: pHZ(32) = 96
      pLX(33) = 96: pLZ(33) = 160:  pHX(33) = 160: pHZ(33) = 256
   NOB(20) = 4: NIndex(20) = 34
      pLX(34) = 1: pLZ(34) = 1:  pHX(34) = 256: pHZ(34) = 32
      pLX(35) = 1: pLZ(35) = 32:  pHX(35) = 32: pHZ(35) = 224
      pLX(36) = 224: pLZ(36) = 32:  pHX(36) = 256: pHZ(36) = 224
      pLX(37) = 1: pLZ(37) = 224:  pHX(37) = 256: pHZ(37) = 256

End Sub

' Trebor Tnemyar

